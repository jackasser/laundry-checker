<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laundry Status Viewer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- React & ReactDOM (Development versions for standalone use) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel Standalone (Compiles JSX in the browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body {
        background-color: #f3f4f6;
      }
      .loader {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3b82f6;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      /* Ensure smooth transitions */
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        const TARGET_URL = "https://laundry.senkaq.com/shop/osaka/osaka-shi-ikuno-ku/4710/";

        // Dictionary
        const LANGUAGES = [
          { 
            code: "en", 
            name: "English", 
            flag: "ðŸ‡ºðŸ‡¸", 
            vocab: {
              hello: "Check Availability",
              remaining_prefix: "Ends in",
              available: "Available",
              washer: "Washer",
              dryer: "Dryer",
              washer_dryer: "Washer/Dryer",
              sneaker_washer: "Shoe Washer",
              sneaker_dryer: "Shoe Dryer",
              shoe: "Shoe Machine",
              min: "min",
              calculating: "Calc...",
              finished: "Finished",
              in_use: "In Use",
              error: "Error"
            }
          },
          { 
            code: "zh-CN", 
            name: "ç®€ä½“ä¸­æ–‡", 
            flag: "ðŸ‡¨ðŸ‡³", 
            vocab: {
              hello: "æ£€æŸ¥å¯ç”¨æ€§",
              remaining_prefix: "å‰©ä½™",
              available: "ç©ºé—²",
              washer: "æ´—è¡£æœº",
              dryer: "çƒ˜å¹²æœº",
              washer_dryer: "æ´—çƒ˜ä¸€ä½“æœº",
              sneaker_washer: "æ´—éž‹æœº",
              sneaker_dryer: "çƒ˜éž‹æœº",
              shoe: "æ´—éž‹è®¾å¤‡",
              min: "åˆ†",
              calculating: "è®¡ç®—ä¸­...",
              finished: "å·²å®Œæˆ",
              in_use: "ä½¿ç”¨ä¸­",
              error: "æ•…éšœ"
            }
          },
          { 
            code: "zh-TW", 
            name: "ç¹é«”ä¸­æ–‡", 
            flag: "ðŸ‡¹ðŸ‡¼", 
            vocab: {
              hello: "æª¢æŸ¥å¯ç”¨æ€§",
              remaining_prefix: "å‰©é¤˜",
              available: "ç©ºé–’",
              washer: "æ´—è¡£æ©Ÿ",
              dryer: "çƒ˜ä¹¾æ©Ÿ",
              washer_dryer: "æ´—çƒ˜ä¸€é«”æ©Ÿ",
              sneaker_washer: "æ´—éž‹æ©Ÿ",
              sneaker_dryer: "çƒ˜éž‹æ©Ÿ",
              shoe: "æ´—éž‹è¨­å‚™",
              min: "åˆ†",
              calculating: "è¨ˆç®—ä¸­...",
              finished: "å·²å®Œæˆ",
              in_use: "ä½¿ç”¨ä¸­",
              error: "æ•…éšœ"
            }
          },
          { 
            code: "ko", 
            name: "í•œêµ­ì–´", 
            flag: "ðŸ‡°ðŸ‡·", 
            vocab: {
              hello: "ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸",
              remaining_prefix: "ë‚¨ì€ ì‹œê°„",
              available: "ì‚¬ìš© ê°€ëŠ¥",
              washer: "ì„¸íƒê¸°",
              dryer: "ê±´ì¡°ê¸°",
              washer_dryer: "ì„¸íƒê±´ì¡°ê¸°",
              sneaker_washer: "ìš´ë™í™” ì„¸íƒê¸°",
              sneaker_dryer: "ìš´ë™í™” ê±´ì¡°ê¸°",
              shoe: "ìš´ë™í™” ì „ìš©",
              min: "ë¶„",
              calculating: "ê³„ì‚° ì¤‘...",
              finished: "ì¢…ë£Œ",
              in_use: "ì‚¬ìš© ì¤‘",
              error: "ê³ ìž¥"
            }
          },
          { 
            code: "ja", 
            name: "æ—¥æœ¬èªž", 
            flag: "ðŸ‡¯ðŸ‡µ", 
            vocab: {
              hello: "ç©ºãçŠ¶æ³ã‚’ç¢ºèª",
              remaining_prefix: "ã‚ã¨",
              available: "ç©ºã",
              washer: "æ´—æ¿¯æ©Ÿ",
              dryer: "ä¹¾ç‡¥æ©Ÿ",
              washer_dryer: "æ´—æ¿¯ä¹¾ç‡¥æ©Ÿ",
              sneaker_washer: "ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼æ´—æ¿¯æ©Ÿ",
              sneaker_dryer: "ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼ä¹¾ç‡¥æ©Ÿ",
              shoe: "ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼ãƒ©ãƒ³ãƒ‰ãƒªãƒ¼",
              min: "åˆ†",
              calculating: "è¨ˆç®—ä¸­...",
              finished: "é‹è»¢çµ‚äº†",
              in_use: "é‹è»¢ä¸­",
              error: "æ•…éšœ"
            }
          },
          { 
            code: "vi", 
            name: "Tiáº¿ng Viá»‡t", 
            flag: "ðŸ‡»ðŸ‡³", 
            vocab: {
              hello: "Kiá»ƒm tra tÃ¬nh tráº¡ng",
              remaining_prefix: "CÃ²n",
              available: "CÃ³ sáºµn",
              washer: "MÃ¡y giáº·t",
              dryer: "MÃ¡y sáº¥y",
              washer_dryer: "MÃ¡y giáº·t sáº¥y",
              sneaker_washer: "MÃ¡y giáº·t giÃ y",
              sneaker_dryer: "MÃ¡y sáº¥y giÃ y",
              shoe: "MÃ¡y giÃ y",
              min: "phÃºt",
              calculating: "Äang tÃ­nh...",
              finished: "ÄÃ£ xong",
              in_use: "Äang cháº¡y",
              error: "Lá»—i"
            }
          },
          { 
            code: "th", 
            name: "à¹„à¸—à¸¢", 
            flag: "ðŸ‡¹ðŸ‡­", 
            vocab: {
              hello: "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°",
              remaining_prefix: "à¹€à¸«à¸¥à¸·à¸­",
              available: "à¸§à¹ˆà¸²à¸‡",
              washer: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸‹à¸±à¸à¸œà¹‰à¸²",
              dryer: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸­à¸šà¸œà¹‰à¸²",
              washer_dryer: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸‹à¸±à¸à¸­à¸š",
              sneaker_washer: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸‹à¸±à¸à¸£à¸­à¸‡à¹€à¸—à¹‰à¸²",
              sneaker_dryer: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸­à¸šà¸£à¸­à¸‡à¹€à¸—à¹‰à¸²",
              shoe: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸‹à¸±à¸à¸£à¸­à¸‡à¹€à¸—à¹‰à¸²",
              min: "à¸™à¸²à¸—à¸µ",
              calculating: "à¸à¸³à¸¥à¸±à¸‡à¸„à¸³à¸™à¸§à¸“...",
              finished: "à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™",
              in_use: "à¸à¸³à¸¥à¸±à¸‡à¸—à¸³à¸‡à¸²à¸™",
              error: "à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”"
            }
          },
          { 
            code: "fr", 
            name: "FranÃ§ais", 
            flag: "ðŸ‡«ðŸ‡·", 
            vocab: {
              hello: "VÃ©rifier la disponibilitÃ©",
              remaining_prefix: "Fin dans",
              available: "Libre",
              washer: "Lave-linge",
              dryer: "SÃ¨che-linge",
              washer_dryer: "Lavant-sÃ©chant",
              sneaker_washer: "Lave-chaussures",
              sneaker_dryer: "SÃ¨che-chaussures",
              shoe: "Machine chaussures",
              min: "min",
              calculating: "Calc...",
              finished: "TerminÃ©",
              in_use: "En cours",
              error: "Erreur"
            }
          }
        ];

        const App = () => {
            const getBrowserLanguage = () => {
                if (typeof navigator === 'undefined') return 'en';
                const lang = navigator.language;
                const exactMatch = LANGUAGES.find(l => l.code === lang);
                if (exactMatch) return exactMatch.code;
                const shortCode = lang.split('-')[0];
                const codeMatch = LANGUAGES.find(l => l.code === shortCode);
                if (codeMatch) return codeMatch.code;
                if (shortCode === 'zh') {
                    if (lang.toLowerCase().includes('tw') || lang.toLowerCase().includes('hk')) return 'zh-TW';
                    return 'zh-CN';
                }
                return 'en';
            };

            const [language, setLanguage] = useState(getBrowserLanguage);
            const [loading, setLoading] = useState(false);
            const [machines, setMachines] = useState(null);
            const [error, setError] = useState(null);
            const [lastUpdated, setLastUpdated] = useState(null);
            const [debugInfo, setDebugInfo] = useState(null);
            const [showDebug, setShowDebug] = useState(false);

            const currentLang = LANGUAGES.find(l => l.code === language) || LANGUAGES[0];
            const vocab = currentLang.vocab;

            const parseLaundryHTML = (html) => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, "text/html");
                const foundMachines = [];
                const processedIds = new Set();

                const getRichText = (el) => {
                    let text = "";
                    const alt = el.getAttribute("alt") || "";
                    const src = (el.getAttribute("src") || "").toLowerCase();
                    const className = (el.getAttribute("class") || "").toLowerCase();
                    
                    text += ` ${alt} ${className} `;
                    
                    if (src.includes("vacant") || src.includes("aki") || src.includes("ok") || src.includes("open") || className.includes("available")) text += " Available ";
                    if (src.includes("working") || src.includes("unten") || src.includes("use") || src.includes("busy") || src.includes("running") || className.includes("busy")) text += " In Use ";
                    if (src.includes("stop") || src.includes("end") || src.includes("finish")) text += " Finished ";
                    
                    if (src.includes("sentaku") || src.includes("wash") || className.includes("wash")) text += " Washer ";
                    if (src.includes("kansou") || src.includes("dry") || className.includes("dry")) text += " Dryer ";
                    if (src.includes("kutsu") || src.includes("shoe") || className.includes("shoe")) text += " Sneaker ";

                    el.childNodes.forEach(node => {
                        if (node.nodeType === Node.TEXT_NODE) {
                            text += (node.textContent || "") + " ";
                        } else if (node.nodeType === Node.ELEMENT_NODE) {
                            const childEl = node;
                            if (!["SCRIPT", "STYLE", "NOSCRIPT"].includes(childEl.tagName)) {
                                text += getRichText(childEl);
                            }
                        }
                    });

                    return text.replace(/\s+/g, " ");
                };

                const candidates = Array.from(doc.querySelectorAll("div, li, tr, article, dl, section, td"));
                const idPattern = /(?:No\.|#|å·æ©Ÿ|^|\s)(\d{1,2})(?:\s|$|å·|ç•ª)/i;
                const typePattern = /æ´—æ¿¯|ä¹¾ç‡¥|Wash|Dry|Sneaker|Shoes|ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼/i;
                // Added "å–ã‚Šå‡ºã—" (Removal/Pickup) to the pattern to detect "Waiting for removal" state
                const statusPattern = /ç©ºã|Available|ç©ºå®¤|åˆ©ç”¨å¯|é‹è»¢ä¸­|ç¨¼åƒä¸­|In Use|çµ‚äº†|Finished|æ®‹ã‚Š|ã‚ã¨|Remaining|min|åˆ†|å–ã‚Šå‡ºã—/i;

                const scoredCandidates = [];

                candidates.forEach(el => {
                    if (el.innerHTML.length > 2000) return;

                    const text = getRichText(el).trim();
                    let score = 0;
                    let id = "";

                    const idMatch = text.match(idPattern);
                    if (idMatch) {
                        id = idMatch[1];
                        score += 10;
                    } else {
                        return; 
                    }

                    if (typePattern.test(text)) score += 5;
                    if (statusPattern.test(text)) score += 5;
                    score -= Math.min(text.length / 100, 5);

                    if (score >= 10) {
                        scoredCandidates.push({ el, text, score, id });
                    }
                });

                scoredCandidates.sort((a, b) => {
                    if (b.score !== a.score) return b.score - a.score;
                    return a.text.length - b.text.length;
                });

                scoredCandidates.forEach(({ text, id }) => {
                    if (processedIds.has(id)) return;

                    let rawType = "washer"; 
                    let rawStatus = "Unknown";
                    let isAvailable = false;
                    let remainingMinutes = undefined;

                    const timeMatch = text.match(/(?:æ®‹ã‚Š|ã‚ã¨|Remaining)?\s*[:ï¼š]?\s*(\d+)\s*(?:åˆ†|min)/i);
                    
                    if (timeMatch) {
                        remainingMinutes = parseInt(timeMatch[1], 10);
                        isAvailable = false;
                        rawStatus = "In Use";
                    } else if (/ç©ºã|Available|ç©ºå®¤|åˆ©ç”¨å¯|Vacant/i.test(text)) {
                        isAvailable = true;
                        rawStatus = "Available";
                    } else if (/é‹è»¢ä¸­|ç¨¼åƒä¸­|In Use|Running|Driving/i.test(text)) {
                        isAvailable = false;
                        rawStatus = "In Use";
                    // Added "å–ã‚Šå‡ºã—" (Waiting for removal) to the Finished state logic
                    } else if (/çµ‚äº†|Finished|Stop|å–ã‚Šå‡ºã—/i.test(text)) {
                        isAvailable = false;
                        rawStatus = "Finished";
                    } else if (/æ•…éšœ|Error|Out of order/i.test(text)) {
                        isAvailable = false;
                        rawStatus = "Error";
                    } else {
                        isAvailable = true;
                        rawStatus = "Available";
                    }

                    if (/æ´—æ¿¯ä¹¾ç‡¥|Washer.*Dryer|æ´—ä¹¾/i.test(text)) rawType = "washer_dryer";
                    else if (/ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼|Shoe/i.test(text)) {
                        if (/ä¹¾ç‡¥|Dry/i.test(text)) rawType = "sneaker_dryer";
                        else rawType = "sneaker_washer";
                    }
                    else if (/ä¹¾ç‡¥|Dry/i.test(text)) rawType = "dryer";
                    else if (/æ´—æ¿¯|Wash/i.test(text)) rawType = "washer";

                    const capMatch = text.match(/(\d+kg)/i);
                    const rawCapacity = capMatch ? capMatch[1] : "";

                    foundMachines.push({
                        id,
                        rawType,
                        rawStatus,
                        rawCapacity,
                        isAvailable,
                        remainingMinutes
                    });

                    processedIds.add(id);
                });

                return foundMachines.sort((a, b) => parseInt(a.id) - parseInt(b.id));
            };

            const handleFetchStatus = async () => {
                setLoading(true);
                setError(null);
                setMachines(null);
                setDebugInfo(null);
                
                let content = "";
                let fetchSuccess = false;

                const proxies = [
                    {
                        name: "CORSProxy.io",
                        url: `https://corsproxy.io/?${encodeURIComponent(TARGET_URL)}`,
                        fetch: async (url) => {
                            const res = await fetch(url);
                            if (!res.ok) throw new Error(`Status ${res.status}`);
                            return await res.text();
                        }
                    },
                    {
                        name: "CodeTabs",
                        url: `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(TARGET_URL)}`,
                        fetch: async (url) => {
                            const res = await fetch(url);
                            if (!res.ok) throw new Error("Status " + res.status);
                            return await res.text();
                        }
                    },
                    {
                        name: "AllOrigins",
                        url: `https://api.allorigins.win/get?url=${encodeURIComponent(TARGET_URL)}&timestamp=${Date.now()}`,
                        fetch: async (url) => {
                            const res = await fetch(url);
                            if (!res.ok) throw new Error("Status " + res.status);
                            const json = await res.json();
                            if (!json.contents) throw new Error("Empty contents");
                            return json.contents;
                        }
                    }
                ];

                try {
                    for (const proxy of proxies) {
                        try {
                            console.log(`Trying proxy: ${proxy.name}`);
                            content = await proxy.fetch(proxy.url);
                            
                            if (content && content.length > 500) {
                                fetchSuccess = true;
                                const titleMatch = content.match(/<title>(.*?)<\/title>/i);
                                const title = titleMatch ? titleMatch[1] : "No Title";
                                setDebugInfo(`Fetched via ${proxy.name}. Length: ${content.length} chars. Title: ${title}`);
                                break;
                            }
                        } catch (e) {
                            console.warn(`Proxy ${proxy.name} failed:`, e);
                            setDebugInfo(prev => (prev || "") + `\n${proxy.name} Failed: ${e.message}`);
                        }
                    }

                    if (!fetchSuccess) {
                        throw new Error("All proxies failed. The site might be blocking access.");
                    }
                    
                    const parsedData = parseLaundryHTML(content);
                    
                    if (parsedData.length === 0) {
                        if (content.length < 500 && content.includes("JavaScript")) {
                            throw new Error("This laundry site requires JavaScript and cannot be auto-read.");
                        }
                        throw new Error("Connected to site, but could not find machine data.");
                    }

                    setMachines(parsedData);
                    setLastUpdated(new Date().toLocaleTimeString());
                    
                } catch (err) {
                    console.error(err);
                    setError(err.message || "Unable to auto-read status.");
                } finally {
                    setLoading(false);
                }
            };

            const getTranslatedType = (rawType) => {
                switch (rawType) {
                    case "washer": return vocab.washer;
                    case "dryer": return vocab.dryer;
                    case "washer_dryer": return vocab.washer_dryer;
                    case "sneaker_washer": return vocab.sneaker_washer;
                    case "sneaker_dryer": return vocab.sneaker_dryer;
                    default: return vocab.washer;
                }
            };

            const getTranslatedCapacity = (cap) => {
                if (!cap) return "";
                return cap; 
            };

            return (
                <div className="min-h-screen font-sans bg-gray-50 text-gray-800 flex flex-col">
                    <header className="bg-white shadow-sm sticky top-0 z-10">
                        <div className="max-w-md mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center gap-2 text-blue-600">
                                <i className="fa-solid fa-soap text-2xl"></i>
                                <h1 className="font-bold text-lg tracking-tight">Laundry Viewer</h1>
                            </div>
                            
                            <div className="relative group">
                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i className="fa-solid fa-earth-americas text-blue-500"></i>
                                </div>
                                <select 
                                    value={language} 
                                    onChange={(e) => setLanguage(e.target.value)}
                                    className="appearance-none bg-blue-50 hover:bg-blue-100 text-blue-900 font-bold rounded-full pl-9 pr-8 py-2 text-sm border border-blue-100 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors cursor-pointer"
                                >
                                    {LANGUAGES.map(l => (
                                        <option key={l.code} value={l.code}>{l.flag} {l.name}</option>
                                    ))}
                                </select>
                                <div className="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none text-blue-400">
                                    <i className="fa-solid fa-chevron-down text-xs"></i>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="flex-grow max-w-md mx-auto w-full p-4 space-y-6 flex flex-col">
                        
                        <div className="bg-white rounded-2xl p-6 shadow-sm border border-blue-50 text-center space-y-4">
                            <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto text-blue-600">
                                <i className="fa-solid fa-shirt text-3xl"></i>
                            </div>
                            <div>
                                <h2 className="text-xl font-bold text-gray-800">Senkaq Laundry</h2>
                                <p className="text-sm text-gray-500 mt-1">Osaka Ikuno-ku</p>
                            </div>
                            
                            <button 
                                onClick={handleFetchStatus}
                                disabled={loading}
                                className="w-full bg-blue-600 hover:bg-blue-700 active:scale-95 text-white text-lg font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-3"
                            >
                                {loading ? (
                                    <>
                                        <div className="loader border-white border-t-transparent"></div>
                                        <span>Checking...</span>
                                    </>
                                ) : (
                                    <>
                                        <i className="fa-solid fa-magnifying-glass"></i>
                                        <span>{vocab.hello}</span>
                                    </>
                                )}
                            </button>
                            
                            {loading && (
                                <p className="text-xs text-gray-400 animate-pulse">
                                    Connecting to laundry system...
                                </p>
                            )}
                        </div>

                        {error && (
                            <div className="bg-red-50 text-red-700 p-4 rounded-xl text-sm border border-red-100 text-center animate-fade-in">
                                <p className="mb-3 font-bold"><i className="fa-solid fa-circle-exclamation mr-1"></i> Check Failed</p>
                                <p className="text-xs mb-3 opacity-90">{error}</p>
                                <div className="flex flex-col gap-2">
                                    <a 
                                        href={TARGET_URL} 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="inline-block bg-white text-red-600 border border-red-200 px-5 py-2 rounded-lg font-bold shadow-sm hover:bg-red-50 text-sm"
                                    >
                                        Open Official Site
                                    </a>
                                    <button 
                                        onClick={() => setShowDebug(!showDebug)}
                                        className="text-xs text-red-400 underline decoration-dotted"
                                    >
                                        {showDebug ? "Hide Debug Info" : "Show Debug Info"}
                                    </button>
                                    {showDebug && debugInfo && (
                                        <pre className="text-[10px] text-left bg-gray-100 p-2 rounded overflow-x-auto whitespace-pre-wrap">
                                            {debugInfo}
                                        </pre>
                                    )}
                                </div>
                            </div>
                        )}

                        {machines && (
                            <div className="space-y-4 animate-fade-in">
                                <div className="flex justify-between items-end px-1">
                                    <h3 className="font-bold text-gray-700 text-lg">Live Status</h3>
                                    <span className="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-full">
                                        Updated: {lastUpdated}
                                    </span>
                                </div>

                                <div className="grid grid-cols-2 gap-3">
                                    {machines.map((machine, idx) => {
                                        const isDryer = machine.rawType.includes("dryer");
                                        const isWasher = machine.rawType.includes("washer");
                                        const isSneaker = machine.rawType.includes("sneaker");
                                        
                                        let iconClass = "fa-soap";
                                        if (isSneaker) iconClass = "fa-shoe-prints";
                                        else if (isDryer && !isWasher) iconClass = "fa-wind"; 
                                        else if (isDryer && isWasher) iconClass = "fa-layer-group";

                                        const translatedType = getTranslatedType(machine.rawType);
                                        const translatedCapacity = getTranslatedCapacity(machine.rawCapacity);

                                        return (
                                            <div 
                                                key={idx} 
                                                className={`relative rounded-xl p-4 flex flex-col justify-between min-h-[140px] transition-all duration-300 ${
                                                    machine.isAvailable 
                                                        ? "bg-white border-2 border-green-100 shadow-sm hover:shadow-md hover:border-green-300" 
                                                        : "bg-gray-50 border-2 border-transparent opacity-90"
                                                }`}
                                            >
                                                <div className="flex justify-between items-start">
                                                    <span className="font-mono text-xs font-bold text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded">
                                                        #{machine.id}
                                                    </span>
                                                    {machine.isAvailable ? (
                                                        <span className="flex h-3 w-3 relative">
                                                            <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                                                            <span className="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                                                        </span>
                                                    ) : (
                                                        <span className="h-2 w-2 rounded-full bg-red-400"></span>
                                                    )}
                                                </div>

                                                <div className="text-center my-2">
                                                    <i className={`fa-solid ${iconClass} text-3xl mb-1 ${machine.isAvailable ? "text-blue-500" : "text-gray-400"}`}></i>
                                                    <div className="text-xs font-bold text-gray-600 leading-tight line-clamp-2">
                                                        {translatedType}
                                                    </div>
                                                    {translatedCapacity && <div className="text-[10px] text-gray-400 mt-0.5">{translatedCapacity}</div>}
                                                </div>

                                                <div className={`text-center text-sm font-bold rounded py-1 ${
                                                    machine.isAvailable 
                                                        ? "text-green-600 bg-green-50" 
                                                        : (machine.rawStatus === "Error" ? "text-gray-500 bg-gray-200" : "text-red-500 bg-red-50")
                                                }`}>
                                                    {machine.isAvailable ? (
                                                        <span>{vocab.available}</span> 
                                                    ) : (
                                                        machine.remainingMinutes !== undefined ? (
                                                            <span className="flex flex-col sm:flex-row items-center justify-center gap-1 text-xs leading-tight">
                                                                <span className="opacity-80 font-medium whitespace-nowrap">{vocab.remaining_prefix}</span>
                                                                <span className="whitespace-nowrap">{machine.remainingMinutes} {vocab.min}</span>
                                                            </span>
                                                        ) : (
                                                            <span>{machine.rawStatus === "Finished" ? vocab.finished : (machine.rawStatus === "Error" ? vocab.error : vocab.in_use)}</span>
                                                        )
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}

                        <div className="text-center pt-8 pb-4">
                            <a 
                                href={TARGET_URL}
                                target="_blank"
                                rel="noopener noreferrer"
                                className="text-xs text-gray-400 hover:text-blue-500 transition underline decoration-dotted"
                            >
                                Source: laundry.senkaq.com
                            </a>
                        </div>
                    </main>
                </div>
            );
        };

        const root = createRoot(document.getElementById("root"));
        root.render(<App />);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>